const p={user:{name:"rozbo",repo:"blog",client_id:"39433d3b141ce642b576",client_secret:"76a75f23eba46b6feabd610232714ef20cad377a"},site:{name:"Jacob's blog"},guest:{access_token_key:"xxxx",user_key:"xxxxdx"}},E={parse(s=window.location.search){if(!s)return{};const e=s[0]==="?"?s.substring(1):s,o={};return e.split("&").forEach(n=>{const[t,r]=n.split("=");t&&(o[t]=r)}),o},stringify(s,e="?"){const o=Object.keys(s).map(n=>`${n}=${encodeURIComponent(s[n]||"")}`).join("&");return o?e+o:""}};function b(s){return function(e,o={},n="https://api.github.com"){const t=new XMLHttpRequest,r=localStorage.getItem(p.guest.access_token_key);let a=`${n}${e}`,c=null;(s==="GET"||s==="DELETE")&&(a+=E.stringify(o));const i=new Promise((l,u)=>{t.addEventListener("load",()=>{var m;const g=(m=t.getResponseHeader("content-type"))!=null?m:"",h=t.responseText;if(!/json/.test(g)){l(h);return}const f=t.responseText?JSON.parse(h):{};f.message?u(new Error(f.message)):l(f)}),t.addEventListener("error",g=>u(g))});return t.open(s,a,!0),t.setRequestHeader("Accept","application/vnd.github.squirrel-girl-preview,application/vnd.github.v3.html+json"),r?t.setRequestHeader("Authorization",`token ${r}`):t.setRequestHeader("Authorization",`Basic ${btoa(`${p.user.client_id}:${p.user.client_secret}`)}`),s!=="GET"&&s!=="DELETE"&&(c=JSON.stringify(o),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Accept","application/json")),t.send(c),i}}const $={get:b("GET"),post:b("POST"),delete:b("DELETE"),put:b("PUT")};function M(s){const e=i=>`0${i}`.slice(-2),o=new Date(s),n=o.getFullYear(),t=o.getMonth()+1,r=o.getDate(),a=o.getHours(),c=o.getMinutes();return`${n}-${e(t)}-${e(r)} ${e(a)}:${e(c)}`}class w{constructor(e){this.r=0,this.g=0,this.b=0,this.h=0,this.s=0,this.l=0,e.length===8?(e.slice(6,8),e=e.slice(0,6)):e.length===4&&(e=e.slice(0,3)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const o=parseInt(e,16),n=o>>16,t=o>>8&255,r=o&255,a=Math.max(n,t,r),c=Math.min(n,t,r);let i=0,l,u=(a+c)/2;if(a===c)i=l=0;else{const g=a-c;switch(l=u>.5?g/(2-a-c):g/(a+c),a){case n:i=(t-r)/g+(t<r?6:0);break;case t:i=(r-n)/g+2;break;case r:i=(n-t)/g+4;break}i/=6}l=l*100,l=Math.round(l),u=u*100,u=Math.round(u),i=Math.round(360*i),this.r=n,this.g=t,this.b=r,this.h=i,this.s=l,this.l=u}}const d={},T=p.user.name,q=`/repos/${T}/${p.user.repo}/issues`,_=(s,e)=>s.labels.filter(t=>t.name===e).length>0;function y(s){s.labels.forEach(o=>{const n=new w(o.color);o.style=`--label-r:${n.r};--label-g:${n.g};--label-b:${n.b};--label-h:${n.h};--label-s:${n.s};--label-l:${n.l};`})}function k(s){var r;const e=s.body_html,o=new DOMParser().parseFromString(e,"text/html"),n=o.querySelectorAll("p");for(let a=0;a<n.length;a++){const c=n[a];if(c.innerText!==""){s.desc=c.innerText;break}}const t=(r=o.querySelector("img"))==null?void 0:r.src;s.thumbnail=t}function R(s=1){return new Promise((e,o)=>{$.get(`/search/issues?q=repo:${p.user.name}/${p.user.repo}+type:issue+-label:hidden&per_page=10&page=${s}&sort=updated`).then(n=>{n.items.forEach(t=>{_(t,"hidden")||(k(t),y(t))}),e(n)},o)})}function S(s){return new Promise((e,o)=>{d[s]?(console.log("bycache"),e(d[s])):$.get(`${q}/${s}`).then(n=>{y(n),d[s]=n,console.log("by get ---"),e(d[s])},o)})}export{R as a,p as c,M as d,S as g};
